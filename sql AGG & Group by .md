ฟังก์ชันรวมข้อมูล (Aggregate Functions) และการจัดกลุ่ม (GROUP BY)
    หลังจากที่เราเรียนรู้การดึงข้อมูลและจัดการข้อมูลแต่ละแถวไปแล้ว คราวนี้เราจะมาเรียนรู้การ "สรุปข้อมูล" กันบ้างค่ะ ซึ่งสำคัญมากๆ ในการวิเคราะห์ข้อมูล เพราะเราไม่ได้ต้องการดูข้อมูลดิบทุกแถวเสมอไป แต่เรามักจะอยากรู้ภาพรวมหรือผลสรุปต่างๆ ค่ะ

    ลองนึกภาพว่าผู้จัดการโรงแรมอยากรู้ว่า:
       - มีพนักงานทั้งหมดกี่คน?
       - เงินเดือนรวมของพนักงานทั้งหมดเท่าไหร่?
       - เงินเดือนเฉลี่ยของพนักงานแต่ละตำแหน่งคือเท่าไหร่?

สิ่งเหล่านี้แหละค่ะที่เราจะใช้ Aggregate Functions และ GROUP BY มาช่วยตอบคำถาม
----------------------------------------------------------------------------------------
Aggregate Functions: ฟังก์ชันที่ใช้สรุปข้อมูล
    ฟังก์ชันเหล่านี้จะรับค่าจากคอลัมน์หลายๆ แถว แล้วคืนค่าออกมาเพียง ค่าเดียว ที่เป็นผลสรุปค่ะ

- COUNT(): ใช้ นับจำนวน แถว หรือจำนวนข้อมูลที่ไม่ใช่ค่าว่าง
- COUNT(*): นับจำนวนแถวทั้งหมดในตาราง (รวมแถวที่มีค่าว่างด้วย)
        ตัวอย่าง >>   SELECT COUNT(*) FROM Employees;

- COUNT(column_name): นับจำนวนค่าที่ไม่ใช่ค่าว่างใน column_name
- COUNT(DISTINCT column_name): นับจำนวนค่าที่ไม่ซ้ำกันใน column_name
  
- SUM(column_name): ใช้ รวมผลรวม ของค่าตัวเลขใน column_name
        ตัวอย่าง >>   SELECT SUM(salary) FROM Employees;

- AVG(column_name): ใช้ หาค่าเฉลี่ย ของค่าตัวเลขใน column_name
        ตัวอย่าง >>   SELECT AVG(salary) FROM Employees;

- MIN(column_name): ใช้ หาค่าน้อยที่สุด ใน column_name
- MAX(column_name): ใช้ หาค่ามากที่สุด ใน column_name
        ตัวอย่าง >>   SELECT MAX(salary), MIN(salary) FROM Employees;


----------------------------------------------------------------------------------------
GROUP BY: การจัดกลุ่มข้อมูลเพื่อสรุปผล
นี่คือคำสั่งที่จะทำให้ Aggregate Functions มีพลังมากขึ้นไปอีกค่ะ! GROUP BY ใช้เมื่อเราต้องการคำนวณผลสรุป สำหรับแต่ละกลุ่ม ของข้อมูล

หน้าที่: จัดกลุ่มแถวที่มีค่าในคอลัมน์ที่ระบุเหมือนกันเข้าด้วยกัน แล้วจึงนำแต่ละกลุ่มนั้นไปคำนวณด้วย Aggregate Functions

                                     รูปแบบ SQL
คำอธิบาย : column_name_for_grouping: คอลัมน์ที่เราต้องการใช้จัดกลุ่ม เช่น position (ตำแหน่งพนักงาน)
    _________________________________________________________________________________
    |SELECT column_name_for_grouping, aggregate_function(column_name_to_summarize)  |
    |FROM table_name                                                                |
    |GROUP BY column_name_for_grouping;                                             |
    ---------------------------------------------------------------------------------

ตัวอย่างการใช้งาน:

อยากรู้จำนวนพนักงานในแต่ละตำแหน่ง: (เราจะ GROUP BY position)
    -----------------------------------------------------
    |SELECT position, COUNT(*) AS total_employees       | # คำอธิบายคือ (เลือก) position, โดยนับ COUNT(*) (ทั้งหมดในตาราง) as total_employees
    |FROM Employees                                     | # (จาก) Employees 
    |GROUP BY position;                                 | # เรียงตาม postion 
    -----------------------------------------------------
#output จะออกมาเป็นประมาณนี้ :

    Front Desk | 2
    Housekeeping | 2
    Manager | 2
    Security | 1
    Housekeeping Supervisor | 1
    CEO | 1

อยากรู้เงินเดือนเฉลี่ยของพนักงานในแต่ละตำแหน่ง
    -----------------------------------------------------
    |SELECT position, AVG(salary) AS avg_salary         |
    |FROM Employees                                     |
    |GROUP BY position;                                 |
    -----------------------------------------------------

หรือถ้าอยากรู้ เงินเดือนรวมและจำนวนพนักงานในแต่ละตำแหน่ง:   
    ---------------------------------------------------------------------------------
    |SELECT position, SUM(salary) AS total_salary, COUNT(*) AS num_employees        |
    |FROM Employees                                                                 |
    |GROUP BY position;                                                             |
    ---------------------------------------------------------------------------------

-----------------------------------------------------------------------------------------------------------------------------------------


HAVING: การกรองกลุ่มข้อมูล

คล้ายกับ WHERE ที่ใช้กรองแถวข้อมูล แต่ HAVING ใช้สำหรับกรอง กลุ่มข้อมูล ที่ได้หลังจาก GROUP BY และคำนวณ Aggregate Functions แล้วเท่านั้นค่ะ
รูปแบบ :
    -------------------------------------------------------------
    |SELECT column_for_grouping, aggregate_function(column)     |
    |FROM table_name                                            |
    |GROUP BY column_for_grouping                               |
    |HAVING aggregate_condition;                                |
    -------------------------------------------------------------

ตัวอย่าง:

อยากรู้เงินเดือนเฉลี่ยของแต่ละตำแหน่ง เฉพาะตำแหน่งที่มีพนักงานมากกว่า 1 คนเท่านั้น:
    -----------------------------------------------------------------------------
    |SELECT position, AVG(salary) AS avg_salary, COUNT(*) AS num_employees      |
    |FROM Employees                                                             |
    |GROUP BY position                                                          |
    |HAVING COUNT(*) > 1;                                                       |
    -----------------------------------------------------------------------------
    คำอธิบาย: (เลือก) position, AVGเฉลี่ย(salary) as ตัวแปรavg_salary, COUNT(*) นับทั้งหมด as ตัวแปร จำนวนพนักงาน num_employees
    (จาก) Employees
    เรียงลำกับตาม postion
    HAVING (ใช้เหมือน if คือการกำหนดเงื่อนไข) จำนวนทั้งหมดCOUNT(*) > 1 (มีมากกว่า 1)

    